<!DOCTYPE html> 
<!-- ! LOOK HERE IF YOU ENTERED A LEVEL ON STARTUP-->
<!-- ! LOOK AROUND LINE 300 TO CHECK THAT GSETUP() IS IN PLACE-->
<html lang="en"> 
  <head>
    <title>Maze Runner</title> 
    <style>
      @charset "utf-8";
      /* CSS Document */
      html,
      html {
        background-color: #383837;
        font-family: Arial, Helvetica, sans-serif;
      }
      #Code {
        position: relative;
        top: 0;
        right: 0;
        width: 60%;
        height: 100%;
        background-color: #383837;
        color: #fff;
        overflow: auto;
        z-index: 100;
      }

    </style>
  </head>
  <body>
    <canvas id="mycanvas"></canvas> 
    <div id="Code">
      <div id="text"
        <h1 id="head">Source Code</h1>
        <p>Embed script done by <a href="https://EmGithub.com">EmGithub.com</a></p>
      </div>
      <div id="embed">
        <pre>
          <code>
            <script id="embd" src="https://emgithub.com/embed-v2.js?target=https%3A%2F%2Fgithub.com%2FIvanButBetter%2FMazeRunner%2Fblob%2Fmain%2FGame%281%29.html&style=atom-one-dark&type=code&showLineNumbers=on&showFullPath=on&showCopy=on"></script>
          </code>
        </pre>
      </div>
    </div>

  </body>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/processing.js/1.4.8/processing.js"></script> 
  <script>
     function programCode(processingInstance) {
      with (processingInstance) {
        size(800, 800); 
        frameRate(60);
        img = loadImage("characterLarge.png");

        // Certain Debugging things
        PFont.list(); {
          console.log("Font List:", PFont.list())
        }

      // Variables
        var StartButton = 0;
        var scene = 0;
        var health = 500;
        var timer = 1;
        var isPlaying = false;
        var img;

        // Buttons
        var b1 = {
          x: 300,
          y: 650,
          width: 150,
          height: 75,
          rounding: 10,
          fill: 166,
          textSize: 30,
          text: "Start"
        }
        var b2 = {
          x: 100,
          y: 650,
          width: 150,
          height: 75,
          rounding: 10,
          fill: 254,
          textSize: 30,
          text: "Try Again"
        }
        var b3 = {
          x: 600,
          y: 650,
          width: 150,
          height: 75,
          rounding: 10,
          fill: 254,
          textSize: 28,
          text: "Title Screen"
        }
        // function to draw all my buttons cleanly
        function btnGen(btn) { 
            fill(btn.fill);
            rect(btn.x, btn.y, btn.width, btn.height, btn.rounding);
            textSize(btn.textSize);
            fill(0);
            textAlign(CENTER, CENTER);
            text(btn.text, btn.x + btn.width / 2, btn.y + btn.height / 2);
        };

        // Hitbox rectangles
        function walls(wall) {
          fill(16, 16, 16);
          noStroke();
          rect(wall.x, wall.y, wall.width, wall.height, wall.rounding);
          if ((mouseX >= wall.x && mouseX <= (wall.x + wall.width) && mouseY >= wall.y && mouseY <= (wall.y + wall.height))) {
            health =  health - 10;
            return health;
          };
        };
        function winbox(win) {
          fill(30, 188, 30);
          rect(win.x, win.y, win.width, win.height, win.rounding);
          if (mouseX <= win.x && mouseY <= win.y);
        };
        //First scene, title screen
        function GSetup() {
          scene = 1;
          background(252, 161, 3);
          fill(255, 255, 255);
          textSize(75);
          text("Maze Runner", 200, 400);
          textSize(45);
          text("Click anywhere to start", 225, 500);
          keyPressed();
          
          health = 5;
        };
        // Call while scene 1 and mouseclicked, make sure button is clicked to continue to game
        function tutorial() {
          scene = 2;
          textAlign(LEFT, TOP);
          background(252, 161, 3);
          fill(0, 0, 0);
          textSize(75);
          text("How to Play", 50, 100);
          textSize(35);
          text("Your character follows your mouse", 50, 200);
          text("Do not hit the black walls", 50, 250);
          text("Do not stand still, the incoming walls will kill you!", 50, 300);
          textSize(75);
          text("Objective", 50, 420);
          textSize(35);
          text("With your mouse, guide the boy to the end of the maze.", 50, 500, 600, 700);
          btnGen(b1);
        };
        //Button input checks
        function MCC(btn) {
            console.log("MouseX:", mouseX, "MouseY:", mouseY); // debugging line
            console.log("btn:", btn);
            return (mouseX >= btn.x && mouseX <= (btn.x + btn.width) && mouseY >= btn.y && mouseY <= (btn.y + btn.height));
        };
      //  function wallColl(wall) {
      //    if (mouseX >= wall.x && mouseX <=(wall.x + wall.width) && mouseY >= wall.y && mouseY <=  (wall.y + wall.height) && isPlaying === true);
      //      isPlaying = false;
      //      gameend();
       // };
        function winColl(win) {
          if (mouseX <= win.x && (win.x + win.width) && mouseY <= win.y && (win.y + win.height));
            NextLevel();
        };
      
        //function PlayerHitbox() { // <!-- !NOT YET WORKING
        //  if(isPlaying === true) {
        //    var playerHitbox = {
        //      x: mouseX - 25,
        //      y: mouseY - 25,
        //      width: 50,
        //      height: 50
        //    };
        //    for(var i = 0; i < walls.length; i++) {
        //      if(rectIntersectsRect(playerHitbox, walls[i])) {
        //        health -= 10;
        //      }
        //    } if(rectIntersectsRect(playerHitbox, win1)) {
        //      NextLevel();
        //    };
        //  };
      // };

        function NextLevel() {
          if (level1 === true) {
            level2();
          } if (level2 === true) {
            level3();
          } if (level3 === true) {
            level4();
          }
        }
        // Mouse controls
        draw = function() {
          if (isPlaying === true) {
            level1() // This puts a bandaid on the draw function
            imageMode(CENTER);
            image(img, mouseX, mouseY, 50, 50);
            timer = timer - 1/60;
            text(timer, 50, 50, 50, 50)
            if (timer <= 0) {
              gameend();
              scene = 666
              
            };
            
          };
        };
        function PlayerDeath() {
          if (isPlaying === true) {
            if (health <= 0) {
              isPlaying = false;
              gameend();
            } else if (timer <= 0) {
              isPlaying = false;
              gameend();
            }
          };
        }
          // Dead Screen
        function gameend() {
          isPlaying = false;
          scene = 666;
          background(0, 0, 0);
          textSize(75);
          fill(255, 0, 0);
          text("You Died", 250, 350);
          textSize(45);
          text("Try Again?", 300, 450);
          btnGen(b2);
          btnGen(b3);

        };
        // Game level 1
        function level1() {
          scene = 3;
          background(98, 98, 98);
          walls(Aw1); walls(Aw2); walls(Aw3); walls(Aw4); walls(Aw5); walls(Aw6);
        //  wallColl(Aw1); wallColl(Aw2); wallColl(Aw3); wallColl(Aw4); wallColl(Aw5); wallColl(Aw6);
          //timer = 15;
          winbox(win1);
        };
          // Level 1 walls
        var Aw1 = {
          x: 0,
          y: 0,
          width: 250,
          height: 100,
        };
        var Aw2 = {
          x: -10,
          y: 400,
          width: 710,
          height: 150,
        };
        var Aw3 = {
          x: 500,
          y: 690,
          width: 900,
          height: 300,
        };
        var Aw4 = {
          x: 0,
          y: 400,
          width: 250,
          height: 500,
        };
        var Aw5 = {
          x: 800,
          y: 200,
          width: -630,
          height: 100,
        };
        var Aw6 = {
          x: 400,
          y: 200,
          width: 800,
          height: -500,
        };
        var win1 = {
          x: 250,
          y: 0,
          width: 150,
          height: 100,
          rounding: 0,
        };

        // Level 2 walls
        function level2() {
          scene = 4;
          background(98, 98, 98);
          walls(Bw1); walls(Bw2); walls(Bw3); walls(Bw4); walls(Bw5); walls(Bw6);
          winbox(win2);
        }
        var Bw1 = {
          x: 0,
          y: 0,
          width: 250,
          height: 410,
        }
        var Bw2 = {
          x: 0,
          y: 350,
          width: 650,
          height: 100,
        }
        var Bw3 = {
          x: 400,
          y: 0,
          width: 150,
          height: 300,
        }
        var Bw4 = {
          x: 650,
          y: 450,
          width: 100,
          height: -350,
        }
        var Bw5 = {
          x: 800,
          y: 500,
          width: -700,
          height: 100,
        }
        var Bw6 = {
          x: 0,
          y: 650,
          width: 800,
          height: 400,
        }
        var win2 = {
          x: 760,
          y: 600,
          width: 150,
          height: 50,
        }
    //Game 
        
//<!-- !  LOOK HERE IF YOU ACCIDENTALLY ENTERED A LEVEL --!>
       GSetup(); //<!--  ! Change this to Setup(); , in case you see anything other than Setup() here. --!>
        

        //Title Screens Changing
        if(scene === 1 || scene === 2 || scene === 0) {
          mouseClicked = function() {
            if(scene === 1) { // Main Menu
              tutorial();
            } else if(MCC(b1)) { // Start Button
              level1();
              isPlaying = true;
            };
          };
        };
        if(scene === 666) { // Dead Screen
          console.log("Dead Screen");
          mouseClicked = function() {
            if (MCC(b2)) {
              level1();
              isPlaying = true;
            } if (MCC(b3)) {
              location.reload();
            };
          };
          // Levels
        if (scene === 3 || scene === 4 || scene === 5 || scene === 6 || scene === 7 || scene === 8 || scene === 9 || scene === 10) {
          if (scene === 3) { // Level 1 to 2
            if (mouseX <= (win.x + win.width) && mouseY <= win.y (win.y + win.height)) {
              level2();
            };
          };
          if (scene === 4) {
            if (mouseX <= win.x && mouseY <= win.y) {
              level3();
            };
          };
          if (scene === 5) {
            if (mouseX <= win.x && mouseY <= win.y) {
              level4();
            };
            };
          };
          if (scene === 6) {
            if (mouseX <= win.x && mouseY <= win.y) {
              level5();
            };
          };
          };
        };
          };
      //  GENERAL NOTES 1. NAMING CONVENTIONS
      // Naming convention is as follows: if you see an A, B, C, or D in from of the letter w, it is to indicate the level where the wall is location. For example, wall Aw1 is in level 1, wall Bw1 is in level 2, and so on.
      // Abnormally high number such as 666 and 999 indicate special scenes, that the player would not normally see if they were in a perfect playthrough. However, scene 666 is an intended part of the game while scene 999 is not.
      // 2. FUNCTIONS
      // MCC stands for Mouse Clicked Check. It is a function that checks if the mouse is clicked within the bounds of a button. Used for scene changes. SYNTAX: MCC(b1)
      // Setup should ALWAYS be the first scene displayed.
      // Level1 is called via the start button.
      // Walls is a specific function to draw walls, it is different than the other by setting the health to 0 when the player collides with it. SYNTAX: walls(Aw1); where Aw1 is the name of the wall.
      // Winbox is a specific function to draw the box that will load the next level. SYNTAX: winbox(win1); where win1 is the name of the winbox.
      // btngen is a function that generates a button. SYNTAX: btngen(1, 100, 100, 100, 100, "Start"); where 1 is the button number, 100 is the x position, 100 is the y position, 100 is the width, 100 is the height, and "Start" is the text on the button.
      // 3. SCENES & THEIR CORRESPONDING DRAWINGS
      // Scene 0 = Loading Screen
      // Scene 1 = Title Screen
      // Scene 2 = Tutorial
      // Scene 3 = Level 1
      // Scene 666 = Game Over
      // Scene 999 = Win Screen
      // 4. VARIABLES
      // 4a. Walls Aw1 through Aw6 are level 1 walls
      // 4B. Buttons
      // Btn 1 is the "Start" button
      // Btn 2 is the "Try Again" button
      // Btn 3 is the "Title Screen" button
      // Btn 999A is the tutorial button
      // Btn 999B is the level 2 button
    var canvas = document.getElementById("mycanvas"); 
    var processingInstance = new Processing(canvas, programCode); 
  </script>
</html>
