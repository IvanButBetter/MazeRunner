<!DOCTYPE html> 
<html lang="en"> 
  <head>
    <title>Maze Runner</title> 
    <style>
      @charset "utf-8";
      /* CSS Document */
      html,
      html {
        background-color: #383837;
        font-family: Arial, Helvetica, sans-serif;
      }
      #Code {
        position: relative;
        top: 0;
        right: 0;
        width: 60%;
        height: 100%;
        background-color: #383837;
        color: #fff;
        overflow: auto;
        z-index: 100;
      }
      #embed {
        position: relative;
        top: 150px;
        right: 0;
        width: 60%;
        height: 100%;
        background-color: #383837;
        color: #fff;
        overflow: auto;
        z-index: 100;
      }
    </style>
  </head>
  <body>
    <canvas id="mycanvas"></canvas> 
    <div id="Code">
      <h1 id="head">Source Code</h1>
      <p>Embed script done by <a href="https://EmGithub.com">EmGithub.com</a></p>
      <pre>
        <code>
          <script id="embd" src="https://emgithub.com/embed-v2.js?target=https%3A%2F%2Fgithub.com%2FIvanButBetter%2FMazeRunner%2Fblob%2Fmain%2FGame%281%29.html&style=atom-one-dark&type=code&showLineNumbers=on&showFullPath=on&showCopy=on"></script>
    </div>

  </body>
  <!-- processing.js lib from KhanAcademy -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/processing.js/1.4.8/processing.js"></script> 
  <script>
    var programCode = function(processingInstance) {
      with (processingInstance) {
        size(800, 800); 
        frameRate(244);

        // Certain Debugging things
        PFont.list(); {
          console.log("Font List:", PFont.list())
        }

      // Variables
        var StartButton = 0;
        var scene = 0;
        var x = mouseX;
        var y = mouseY;
        var health = 1;
        var timer = 30;
        var isPlaying = false;
        var img;
        // Buttons
        var b1 = {
          x: 300,
          y: 650,
          width: 150,
          height: 75,
          rounding: 10,
          fill: 166,
          textSize: 30,
          text: "Start"
        }
        var b2 = {
          x: 100,
          y: 650,
          width: 150,
          height: 75,
          rounding: 10,
          fill: 254,
          textSize: 30,
          text: "Try Again"
        }
        var b3 = {
          x: 600,
          y: 650,
          width: 150,
          height: 75,
          rounding: 10,
          fill: 254,
          textSize: 28,
          text: "Title Screen"
        }
        var b999A = {
          x: 0,
          y: 300,
          width: 100,
          height: 100,
          rounding: 10,
          fill: 0,
          textSize: 28,
          text: "Tutorial"
        }
        var b999B = {
          x: 0,
          y: 450,
          width: 100,
          height: 100,
          rounding: 10,
          fill: 0,
          textSize: 28,
          text: "Level 2"
        }
        // function to draw all my buttons cleanly
        var btnGen = function(btn) {
            fill(btn.fill);
            rect(btn.x, btn.y, btn.width, btn.height, btn.rounding);
            textSize(btn.textSize);
            fill(0);
            textAlign(CENTER, CENTER);
            text(btn.text, btn.x + btn.width / 2, btn.y + btn.height / 2);
            stroke(btn.stroke)
        };

        // Hitbox rectangles
        var walls = function(wall) {
          fill(16, 16, 16);
          rect(wall.x, wall.y, wall.width, wall.height, wall.rounding);
          if (mouseX <= wall.x && mouseY <= wall.y);
            health = 0;
        };
        var winbox = function(win) {
          fill(30, 188, 30);
          rect(win.x, win.y, win.width, win.height, win.rounding);
          if (mouseX <= win.x && mouseY <= win.y);
        };
        //First scene, title screen
        var Setup = function() {
          scene = 1;
          background(252, 161, 3);
          fill(255, 255, 255);
          textSize(75);
          text("Maze Runner", 200, 400);
          textSize(45);
          text("Click anywhere to start", 225, 500);
          keyPressed();
          img = loadImage("characterLarge.png");
        };
        // Call while scene 1 and mouseclicked, make sure button is clicked to continue to game
        var tutorial = function() {
          scene = 2;
          textAlign(LEFT, TOP);
          background(252, 161, 3);
          fill(0, 0, 0);
          textSize(75);
          text("How to Play", 50, 100);
          textSize(35);
          text("Your character follows your mouse", 50, 200);
          text("Do not hit the black walls", 50, 250);
          text("Do not stand still, the incoming walls will kill you!", 50, 300);
          textSize(75);
          text("Objective", 50, 420);
          textSize(35);
          text("With your mouse, guide the boy to the end of the maze.", 50, 500, 600, 700);
          btnGen(b1);
        };
        var DevGui = function() {
          scene = 999;
          background(200, 200, 200);
          textSize(20);
          fill(0, 0, 0);
          text("Developer GUI", 10, 20);
          text("Scene: " + scene, 10, 40);
          text("If you got here by accident, please refresh the page.", 10, 60);
          text("If the issue persists, check line 300 of the code.", 10, 80);
          text("If the function there is anything EXCEPT Setup(), change it to Setup();", 10, 100)
          btnGen(b1); btnGen(b2); btnGen(b3); btnGen(b4); btnGen(b999A); btnGen(b999B);
        };

        //Button input checks
        var MCC = function(btn) {
            console.log("MouseX:", mouseX, "MouseY:", mouseY); // debugging line
            console.log("btn:", btn);
            return (mouseX >= btn.x && mouseX <= (btn.x + btn.width) && mouseY >= btn.y && mouseY <= (btn.y + btn.height));
        };
        var wallColl = function(wall){
          if (isPlaying === true && mouseX <= wall.x && mouseY <= wall.y);
            health = -10;
        };
        var winColl = function(win) {
          if (isPlaying === true && mouseX <= win.x && mouseY <= win.y);
            level2();
        };

        // Mouse controls
        draw = function() {
          if (isPlaying === true) {
            imageMode(CENTER)
            image(img, mouseX, mouseY, 50, 50);
          } else if (isPlaying === true && mouseX <= (wall.x + wall.width) && mouseY <= (wall.y + wall.height)); {
            health = -10;
          };
        };
        // Dead Screen
        var gameend = function() {
          scene = 666;
          background(0, 0, 0);
          textSize(75)
          fill(255, 0, 0)
          text("You Died", 250, 350)
          textSize(45)
          text("Try Again?", 300, 450)
          btnGen(b2)
          btnGen(b3)

        };
        // Game level 1
        var level1 = function() {
          scene = 3
          background(98, 98, 98);
          walls(Aw1); walls(Aw2); walls(Aw3); walls(Aw4); walls(Aw5); walls(Aw6);
          wallColl(Aw1); wallColl(Aw2); wallColl(Aw3); wallColl(Aw4); wallColl(Aw5); wallColl(Aw6);
          timer = 30;
          winbox(win1);
        };
          // Level 1 walls
        var Aw1 = {
          x: 0,
          y: 0,
          width: 250,
          height: 100,
        };
        var Aw2 = {
          x: -10,
          y: 400,
          width: 710,
          height: 150,
        };
        var Aw3 = {
          x: 500,
          y: 690,
          width: 900,
          height: 300,
        };
        var Aw4 = {
          x: 0,
          y: 400,
          width: 250,
          height: 500,
        };
        var Aw5 = {
          x: 800,
          y: 200,
          width: -630,
          height: 100,
        };
        var Aw6 = {
          x: 400,
          y: 210,
          width: 800,
          height: -500,
        };
        var win1 = {
          x: 250,
          y: 0,
          width: 150,
          height: 100,
          rounding: 0,
        };

        // Level 2
        var level2 = function(){ 
          scene = 4;
          background(98, 98, 98);
          walls(Bw1); walls(Bw2); walls(Bw3); walls(Bw4); walls(Bw5); walls(Bw6);
          winbox(win2);
        }
        var Bw1 = {
          x: 0,
          y: 0,
          width: 250,
          height: 410,
        }
        var Bw2 = {
          x: 0,
          y: 350,
          width: 650,
          height: 100,
        }
        var Bw3 = {
          x: 400,
          y: 0,
          width: 150,
          height: 300,
        }
        var Bw4 = {
          x: 650,
          y: 450,
          width: 100,
          height: -350,
        }
        var Bw5 = {
          x: 800,
          y: 500,
          width: -700,
          height: 100,
        }
        var Bw6 = {
          x: 0,
          y: 650,
          width: 800,
          height: 400,
        }
        var win2 = {
          x: 760,
          y: 600,
          width: 150,
          height: 50,
        }
    //Game 
        
//  LOOK HERE IF YOU ACCIDENTALLY ENTERED THE DEVELOPER GUI 
      Setup(); // ! Change this to Setup(); , in case you see anything other than Setup() here.
      
        if (health <= 0) { // This code is problematic - it causes the game to display but not accept input
          GameEnd();
        };
        

        //Title Screens Changing
        if(scene === 1 || scene === 2 || scene === 0) {
          mouseClicked = function() {
            if(scene === 1) { // Main Menu
              tutorial();
            } else if(MCC(b1)) { // Start Button
              level1();
              isPlaying = true;
            };
          };
        };
        if(scene === 666) { // Dead Screen
          mouseClicked = function() {
            if (MCC(b2)) {
              level1();
              isPlaying = true;
            } else if (MCC(b3)) {
              location.reload();
            };
          };
          // Levels
        if (scene === 3 || scene === 4 || scene === 5 || scene === 6 || scene === 7 || scene === 8 || scene === 9 || scene === 10) {
          if (scene === 3) { // Level 1 to 2
            if (mouseX <= (win.x + win.width) && mouseY <= win.y (win.y + win.height)) {
              level2();
            };
          };
          if (scene === 4) {
            if (mouseX <= win.x && mouseY <= win.y) {
              level3();
            };
          };
          if (scene === 5) {
            if (mouseX <= win.x && mouseY <= win.y) {
              level4();
            };
            };
          };
          if (scene === 6) {
            if (mouseX <= win.x && mouseY <= win.y) {
              level5();
            };
          };
          };
        };
          
        // DEVELOPER GUI
        // DeveloperScene Function
          if (scene === 999)
           mouseClicked = function() {
            if (MCC(b1)) {
              level1();
            } else if (MCC(b3)) {
              location.reload();
            } else if (MCC(b999A)) {
              tutorial();
            } else if (MCC(b999B)) {
              level2();
            };
           };
          };
      // GENERAL NOTES 1. NAMING CONVENTIONS
      // Naming convention is as follows: if you see an A, B, C, or D in from of the letter w, it is to indicate the level where the wall is location. For example, wall Aw1 is in level 1, wall Bw1 is in level 2, and so on.
      // Abnormally high number such as 666 and 999 indicate special scenes, that the player would not normally see if they were in a perfect playthrough. However, scene 666 is an intended part of the game while scene 999 is not.
      // 2. FUNCTIONS
      // MCC stands for Mouse Clicked Check. It is a function that checks if the mouse is clicked within the bounds of a button. Used for scene changes. SYNTAX: MCC(b1)
      // DevGui is the developer GUI. It is used to test the game and to make sure that everything is working properly. It is not intended to be seen by the player. Call via DevGui();
      // Setup should ALWAYS be the first scene displayed.
      // Level1 is called via the start button.
      // Walls is a specific function to draw walls, it is different than the other by setting the health to 0 when the player collides with it. SYNTAX: walls(Aw1); where Aw1 is the name of the wall.
      // Winbox is a specific function to draw the box that will load the next level. SYNTAX: winbox(win1); where win1 is the name of the winbox.
      // btngen is a function that generates a button. SYNTAX: btngen(1, 100, 100, 100, 100, "Start"); where 1 is the button number, 100 is the x position, 100 is the y position, 100 is the width, 100 is the height, and "Start" is the text on the button.
      // 3. SCENES & THEIR CORRESPONDING DRAWINGS
      // Scene 0 = Loading Screen
      // Scene 1 = Title Screen
      // Scene 2 = Tutorial
      // Scene 3 = Level 1
      // Scene 666 = Game Over
      // Scene 999 = Developer GUI
      // 4. VARIABLES
      // 4a. Walls Aw1 through Aw6 are level 1 walls
      // 4B. Buttons
      // Btn 1 is the "Start" button
      // Btn 2 is the "Try Again" button
      // Btn 3 is the "Title Screen" button
      // Btn 999A is the tutorial button
      // Btn 999B is the level 2 button
    var canvas = document.getElementById("mycanvas"); 
    var processingInstance = new Processing(canvas, programCode); 
  </script>
</html>
